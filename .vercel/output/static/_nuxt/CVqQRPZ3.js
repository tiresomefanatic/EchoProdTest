import{g as ve,r as I,l as j,S as Qe,c as T,a2 as Te,a3 as ue,a4 as de,s as Ee,a5 as Ze,V as et,i as Oe,a6 as tt,a7 as nt,k as N,a8 as Ae,m as me,o as w,D as st,p as H,n as Y,b as C,t as rt,N as Q,q as F,d as pe,C as it,a9 as ot,v as at}from"./DpbXZn14.js";import{N as x,m as S,w as U,M as se,a as K,b as W,S as J,t as ge,P as re,c as ye,T as D,d as lt,E as ie,k as ut,e as be,F as Le,f as Re,D as dt,g as pt,h as ct,i as ft,j as ht,l as mt,n as $e,V as gt,o as vt,p as yt}from"./B3THjRu3.js";import bt from"./Hi6R_XZp.js";import{u as kt,C as Mt}from"./Bco5xEST.js";import{u as Ct}from"./DES18ZVy.js";import wt from"./CrcsxJmM.js";const Tt=Symbol.for("nuxt:client-only"),Z="<div></div>",Xn=ve({name:"ClientOnly",inheritAttrs:!1,props:["fallback","placeholder","placeholderTag","fallbackTag"],setup(t,{slots:e,attrs:n}){const s=I(!1);return j(()=>{s.value=!0}),Qe(Tt,!0),r=>{var p;if(s.value)return(p=e.default)==null?void 0:p.call(e);const i=e.fallback||e.placeholder;if(i)return i();const o=r.fallback||r.placeholder||"",a=r.fallbackTag||r.placeholderTag||"span";return T(a,n,o)}}}),ce=new WeakMap;function At(t){if(ce.has(t))return ce.get(t);const e={...t};return e.render?e.render=(n,s,r,i,o,a)=>{var p;if(i.mounted$??n.mounted$){const d=(p=t.render)==null?void 0:p.bind(n)(n,s,r,i,o,a);return d.children===null||typeof d.children=="string"?Te(d):ue(d)}return de(n._.vnode.el,Z)}:e.template&&(e.template=`
      <template v-if="mounted$">${t.template}</template>
      <template v-else>${Z}</template>
    `),e.setup=(n,s)=>{var p;const r=Ee(),i=I(r.isHydrating===!1),o=et();if(r.isHydrating){const d={...o.attrs},h=Lt(o);for(const u in d)delete o.attrs[u];j(()=>{Object.assign(o.attrs,d),o.vnode.dirs=h})}j(()=>{i.value=!0});const a=((p=t.setup)==null?void 0:p.call(t,n,s))||{};return Ze(a)?Promise.resolve(a).then(d=>typeof d!="function"?(d||(d={}),d.mounted$=i,d):(...h)=>{if(i.value||!r.isHydrating){const u=d(...h);return u.children===null||typeof u.children=="string"?Te(u):ue(u)}return de(o==null?void 0:o.vnode.el,Z)}):typeof a=="function"?(...d)=>i.value?ue(a(...d),s.attrs):de(o==null?void 0:o.vnode.el,Z):Object.assign(a,{mounted$:i})},ce.set(t,e),e}function Lt(t){if(!t||!t.vnode.dirs)return null;const e=t.vnode.dirs;return t.vnode.dirs=null,e}const xt=ve({__name:"MonacoEditor.client",props:{lang:{default:()=>"plaintext"},options:{default:()=>({})},modelUri:{},modelValue:{default:()=>""}},emits:["update:modelValue","load"],setup(t,{expose:e,emit:n}){const s=t,r=n,i=I(!0),o=Oe(()=>s.lang||s.options.language),a=tt(),p=I(),d=nt(),h={automaticLayout:!0};let u,c;return N(()=>s.modelValue,()=>{(u==null?void 0:u.getValue())!==s.modelValue&&(u==null||u.setValue(s.modelValue))}),N(()=>[s.lang,s.modelUri],()=>{c&&c.dispose(),c=d.editor.createModel(s.modelValue,o.value,s.modelUri),u==null||u.setModel(c)}),N(()=>s.options,()=>{u==null||u.updateOptions(Ae(s.options,h))}),N(p,(m,v)=>{!p.value||v||(u=d.editor.create(p.value,Ae(s.options,h)),c=d.editor.createModel(s.modelValue,o.value,s.modelUri),a.value=u,u.layout(),u.setModel(c),u.onDidChangeModelContent(()=>{r("update:modelValue",u.getValue())}),i.value=!1,r("load",u))}),e({$editor:a}),me(()=>{u==null||u.dispose(),c==null||c.dispose()}),(m,v)=>(w(),T("div",{ref_key:"editorElement",ref:p},[i.value?st(m.$slots,"default",{key:0}):H("",!0)],512))}}),St=/^\s*>\s$/,Ht=x.create({name:"blockquote",addOptions(){return{HTMLAttributes:{}}},content:"block+",group:"block",defining:!0,parseHTML(){return[{tag:"blockquote"}]},renderHTML({HTMLAttributes:t}){return["blockquote",S(this.options.HTMLAttributes,t),0]},addCommands(){return{setBlockquote:()=>({commands:t})=>t.wrapIn(this.name),toggleBlockquote:()=>({commands:t})=>t.toggleWrap(this.name),unsetBlockquote:()=>({commands:t})=>t.lift(this.name)}},addKeyboardShortcuts(){return{"Mod-Shift-b":()=>this.editor.commands.toggleBlockquote()}},addInputRules(){return[U({find:St,type:this.type})]}}),It=/(?:^|\s)(\*\*(?!\s+\*\*)((?:[^*]+))\*\*(?!\s+\*\*))$/,_t=/(?:^|\s)(\*\*(?!\s+\*\*)((?:[^*]+))\*\*(?!\s+\*\*))/g,Pt=/(?:^|\s)(__(?!\s+__)((?:[^_]+))__(?!\s+__))$/,Et=/(?:^|\s)(__(?!\s+__)((?:[^_]+))__(?!\s+__))/g,Ot=se.create({name:"bold",addOptions(){return{HTMLAttributes:{}}},parseHTML(){return[{tag:"strong"},{tag:"b",getAttrs:t=>t.style.fontWeight!=="normal"&&null},{style:"font-weight=400",clearMark:t=>t.type.name===this.name},{style:"font-weight",getAttrs:t=>/^(bold(er)?|[5-9]\d{2,})$/.test(t)&&null}]},renderHTML({HTMLAttributes:t}){return["strong",S(this.options.HTMLAttributes,t),0]},addCommands(){return{setBold:()=>({commands:t})=>t.setMark(this.name),toggleBold:()=>({commands:t})=>t.toggleMark(this.name),unsetBold:()=>({commands:t})=>t.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-b":()=>this.editor.commands.toggleBold(),"Mod-B":()=>this.editor.commands.toggleBold()}},addInputRules(){return[K({find:It,type:this.type}),K({find:Pt,type:this.type})]},addPasteRules(){return[W({find:_t,type:this.type}),W({find:Et,type:this.type})]}}),Rt="listItem",xe="textStyle",Se=/^\s*([-+*])\s$/,$t=x.create({name:"bulletList",addOptions(){return{itemTypeName:"listItem",HTMLAttributes:{},keepMarks:!1,keepAttributes:!1}},group:"block list",content(){return`${this.options.itemTypeName}+`},parseHTML(){return[{tag:"ul"}]},renderHTML({HTMLAttributes:t}){return["ul",S(this.options.HTMLAttributes,t),0]},addCommands(){return{toggleBulletList:()=>({commands:t,chain:e})=>this.options.keepAttributes?e().toggleList(this.name,this.options.itemTypeName,this.options.keepMarks).updateAttributes(Rt,this.editor.getAttributes(xe)).run():t.toggleList(this.name,this.options.itemTypeName,this.options.keepMarks)}},addKeyboardShortcuts(){return{"Mod-Shift-8":()=>this.editor.commands.toggleBulletList()}},addInputRules(){let t=U({find:Se,type:this.type});return(this.options.keepMarks||this.options.keepAttributes)&&(t=U({find:Se,type:this.type,keepMarks:this.options.keepMarks,keepAttributes:this.options.keepAttributes,getAttributes:()=>this.editor.getAttributes(xe),editor:this.editor})),[t]}}),Dt=/(^|[^`])`([^`]+)`(?!`)/,Bt=/(^|[^`])`([^`]+)`(?!`)/g,Nt=se.create({name:"code",addOptions(){return{HTMLAttributes:{}}},excludes:"_",code:!0,exitable:!0,parseHTML(){return[{tag:"code"}]},renderHTML({HTMLAttributes:t}){return["code",S(this.options.HTMLAttributes,t),0]},addCommands(){return{setCode:()=>({commands:t})=>t.setMark(this.name),toggleCode:()=>({commands:t})=>t.toggleMark(this.name),unsetCode:()=>({commands:t})=>t.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-e":()=>this.editor.commands.toggleCode()}},addInputRules(){return[K({find:Dt,type:this.type})]},addPasteRules(){return[W({find:Bt,type:this.type})]}}),Vt=/^```([a-z]+)?[\s\n]$/,zt=/^~~~([a-z]+)?[\s\n]$/,Ft=x.create({name:"codeBlock",addOptions(){return{languageClassPrefix:"language-",exitOnTripleEnter:!0,exitOnArrowDown:!0,defaultLanguage:null,HTMLAttributes:{}}},content:"text*",marks:"",group:"block",code:!0,defining:!0,addAttributes(){return{language:{default:this.options.defaultLanguage,parseHTML:t=>{var e;const{languageClassPrefix:n}=this.options,i=[...((e=t.firstElementChild)===null||e===void 0?void 0:e.classList)||[]].filter(o=>o.startsWith(n)).map(o=>o.replace(n,""))[0];return i||null},rendered:!1}}},parseHTML(){return[{tag:"pre",preserveWhitespace:"full"}]},renderHTML({node:t,HTMLAttributes:e}){return["pre",S(this.options.HTMLAttributes,e),["code",{class:t.attrs.language?this.options.languageClassPrefix+t.attrs.language:null},0]]},addCommands(){return{setCodeBlock:t=>({commands:e})=>e.setNode(this.name,t),toggleCodeBlock:t=>({commands:e})=>e.toggleNode(this.name,"paragraph",t)}},addKeyboardShortcuts(){return{"Mod-Alt-c":()=>this.editor.commands.toggleCodeBlock(),Backspace:()=>{const{empty:t,$anchor:e}=this.editor.state.selection,n=e.pos===1;return!t||e.parent.type.name!==this.name?!1:n||!e.parent.textContent.length?this.editor.commands.clearNodes():!1},Enter:({editor:t})=>{if(!this.options.exitOnTripleEnter)return!1;const{state:e}=t,{selection:n}=e,{$from:s,empty:r}=n;if(!r||s.parent.type!==this.type)return!1;const i=s.parentOffset===s.parent.nodeSize-2,o=s.parent.textContent.endsWith(`

`);return!i||!o?!1:t.chain().command(({tr:a})=>(a.delete(s.pos-2,s.pos),!0)).exitCode().run()},ArrowDown:({editor:t})=>{if(!this.options.exitOnArrowDown)return!1;const{state:e}=t,{selection:n,doc:s}=e,{$from:r,empty:i}=n;if(!i||r.parent.type!==this.type||!(r.parentOffset===r.parent.nodeSize-2))return!1;const a=r.after();return a===void 0?!1:s.nodeAt(a)?t.commands.command(({tr:d})=>(d.setSelection(J.near(s.resolve(a))),!0)):t.commands.exitCode()}}},addInputRules(){return[ge({find:Vt,type:this.type,getAttributes:t=>({language:t[1]})}),ge({find:zt,type:this.type,getAttributes:t=>({language:t[1]})})]},addProseMirrorPlugins(){return[new re({key:new ye("codeBlockVSCodeHandler"),props:{handlePaste:(t,e)=>{if(!e.clipboardData||this.editor.isActive(this.type.name))return!1;const n=e.clipboardData.getData("text/plain"),s=e.clipboardData.getData("vscode-editor-data"),r=s?JSON.parse(s):void 0,i=r==null?void 0:r.mode;if(!n||!i)return!1;const{tr:o,schema:a}=t.state,p=a.text(n.replace(/\r\n?/g,`
`));return o.replaceSelectionWith(this.type.create({language:i},p)),o.selection.$from.parent.type!==this.type&&o.setSelection(D.near(o.doc.resolve(Math.max(0,o.selection.from-2)))),o.setMeta("paste",!0),t.dispatch(o),!0}}})]}}),De=x.create({name:"doc",topNode:!0,content:"block+"});function Kt(t={}){return new re({view(e){return new Wt(e,t)}})}class Wt{constructor(e,n){var s;this.editorView=e,this.cursorPos=null,this.element=null,this.timeout=-1,this.width=(s=n.width)!==null&&s!==void 0?s:1,this.color=n.color===!1?void 0:n.color||"black",this.class=n.class,this.handlers=["dragover","dragend","drop","dragleave"].map(r=>{let i=o=>{this[r](o)};return e.dom.addEventListener(r,i),{name:r,handler:i}})}destroy(){this.handlers.forEach(({name:e,handler:n})=>this.editorView.dom.removeEventListener(e,n))}update(e,n){this.cursorPos!=null&&n.doc!=e.state.doc&&(this.cursorPos>e.state.doc.content.size?this.setCursor(null):this.updateOverlay())}setCursor(e){e!=this.cursorPos&&(this.cursorPos=e,e==null?(this.element.parentNode.removeChild(this.element),this.element=null):this.updateOverlay())}updateOverlay(){let e=this.editorView.state.doc.resolve(this.cursorPos),n=!e.parent.inlineContent,s;if(n){let a=e.nodeBefore,p=e.nodeAfter;if(a||p){let d=this.editorView.nodeDOM(this.cursorPos-(a?a.nodeSize:0));if(d){let h=d.getBoundingClientRect(),u=a?h.bottom:h.top;a&&p&&(u=(u+this.editorView.nodeDOM(this.cursorPos).getBoundingClientRect().top)/2),s={left:h.left,right:h.right,top:u-this.width/2,bottom:u+this.width/2}}}}if(!s){let a=this.editorView.coordsAtPos(this.cursorPos);s={left:a.left-this.width/2,right:a.left+this.width/2,top:a.top,bottom:a.bottom}}let r=this.editorView.dom.offsetParent;this.element||(this.element=r.appendChild(document.createElement("div")),this.class&&(this.element.className=this.class),this.element.style.cssText="position: absolute; z-index: 50; pointer-events: none;",this.color&&(this.element.style.backgroundColor=this.color)),this.element.classList.toggle("prosemirror-dropcursor-block",n),this.element.classList.toggle("prosemirror-dropcursor-inline",!n);let i,o;if(!r||r==document.body&&getComputedStyle(r).position=="static")i=-pageXOffset,o=-pageYOffset;else{let a=r.getBoundingClientRect();i=a.left-r.scrollLeft,o=a.top-r.scrollTop}this.element.style.left=s.left-i+"px",this.element.style.top=s.top-o+"px",this.element.style.width=s.right-s.left+"px",this.element.style.height=s.bottom-s.top+"px"}scheduleRemoval(e){clearTimeout(this.timeout),this.timeout=setTimeout(()=>this.setCursor(null),e)}dragover(e){if(!this.editorView.editable)return;let n=this.editorView.posAtCoords({left:e.clientX,top:e.clientY}),s=n&&n.inside>=0&&this.editorView.state.doc.nodeAt(n.inside),r=s&&s.type.spec.disableDropCursor,i=typeof r=="function"?r(this.editorView,n,e):r;if(n&&!i){let o=n.pos;if(this.editorView.dragging&&this.editorView.dragging.slice){let a=lt(this.editorView.state.doc,o,this.editorView.dragging.slice);a!=null&&(o=a)}this.setCursor(o),this.scheduleRemoval(5e3)}}dragend(){this.scheduleRemoval(20)}drop(){this.scheduleRemoval(20)}dragleave(e){(e.target==this.editorView.dom||!this.editorView.dom.contains(e.relatedTarget))&&this.setCursor(null)}}const Gt=ie.create({name:"dropCursor",addOptions(){return{color:"currentColor",width:1,class:void 0}},addProseMirrorPlugins(){return[Kt(this.options)]}});class b extends J{constructor(e){super(e,e)}map(e,n){let s=e.resolve(n.map(this.head));return b.valid(s)?new b(s):J.near(s)}content(){return Re.empty}eq(e){return e instanceof b&&e.head==this.head}toJSON(){return{type:"gapcursor",pos:this.head}}static fromJSON(e,n){if(typeof n.pos!="number")throw new RangeError("Invalid input for GapCursor.fromJSON");return new b(e.resolve(n.pos))}getBookmark(){return new ke(this.anchor)}static valid(e){let n=e.parent;if(n.isTextblock||!qt(e)||!jt(e))return!1;let s=n.type.spec.allowGapCursor;if(s!=null)return s;let r=n.contentMatchAt(e.index()).defaultType;return r&&r.isTextblock}static findGapCursorFrom(e,n,s=!1){e:for(;;){if(!s&&b.valid(e))return e;let r=e.pos,i=null;for(let o=e.depth;;o--){let a=e.node(o);if(n>0?e.indexAfter(o)<a.childCount:e.index(o)>0){i=a.child(n>0?e.indexAfter(o):e.index(o)-1);break}else if(o==0)return null;r+=n;let p=e.doc.resolve(r);if(b.valid(p))return p}for(;;){let o=n>0?i.firstChild:i.lastChild;if(!o){if(i.isAtom&&!i.isText&&!be.isSelectable(i)){e=e.doc.resolve(r+i.nodeSize*n),s=!1;continue e}break}i=o,r+=n;let a=e.doc.resolve(r);if(b.valid(a))return a}return null}}}b.prototype.visible=!1;b.findFrom=b.findGapCursorFrom;J.jsonID("gapcursor",b);class ke{constructor(e){this.pos=e}map(e){return new ke(e.map(this.pos))}resolve(e){let n=e.resolve(this.pos);return b.valid(n)?new b(n):J.near(n)}}function qt(t){for(let e=t.depth;e>=0;e--){let n=t.index(e),s=t.node(e);if(n==0){if(s.type.spec.isolating)return!0;continue}for(let r=s.child(n-1);;r=r.lastChild){if(r.childCount==0&&!r.inlineContent||r.isAtom||r.type.spec.isolating)return!0;if(r.inlineContent)return!1}}return!0}function jt(t){for(let e=t.depth;e>=0;e--){let n=t.indexAfter(e),s=t.node(e);if(n==s.childCount){if(s.type.spec.isolating)return!0;continue}for(let r=s.child(n);;r=r.firstChild){if(r.childCount==0&&!r.inlineContent||r.isAtom||r.type.spec.isolating)return!0;if(r.inlineContent)return!1}}return!0}function Ut(){return new re({props:{decorations:Qt,createSelectionBetween(t,e,n){return e.pos==n.pos&&b.valid(n)?new b(n):null},handleClick:Xt,handleKeyDown:Jt,handleDOMEvents:{beforeinput:Yt}}})}const Jt=ut({ArrowLeft:ee("horiz",-1),ArrowRight:ee("horiz",1),ArrowUp:ee("vert",-1),ArrowDown:ee("vert",1)});function ee(t,e){const n=t=="vert"?e>0?"down":"up":e>0?"right":"left";return function(s,r,i){let o=s.selection,a=e>0?o.$to:o.$from,p=o.empty;if(o instanceof D){if(!i.endOfTextblock(n)||a.depth==0)return!1;p=!1,a=s.doc.resolve(e>0?a.after():a.before())}let d=b.findGapCursorFrom(a,e,p);return d?(r&&r(s.tr.setSelection(new b(d))),!0):!1}}function Xt(t,e,n){if(!t||!t.editable)return!1;let s=t.state.doc.resolve(e);if(!b.valid(s))return!1;let r=t.posAtCoords({left:n.clientX,top:n.clientY});return r&&r.inside>-1&&be.isSelectable(t.state.doc.nodeAt(r.inside))?!1:(t.dispatch(t.state.tr.setSelection(new b(s))),!0)}function Yt(t,e){if(e.inputType!="insertCompositionText"||!(t.state.selection instanceof b))return!1;let{$from:n}=t.state.selection,s=n.parent.contentMatchAt(n.index()).findWrapping(t.state.schema.nodes.text);if(!s)return!1;let r=Le.empty;for(let o=s.length-1;o>=0;o--)r=Le.from(s[o].createAndFill(null,r));let i=t.state.tr.replace(n.pos,n.pos,new Re(r,0,0));return i.setSelection(D.near(i.doc.resolve(n.pos+1))),t.dispatch(i),!1}function Qt(t){if(!(t.selection instanceof b))return null;let e=document.createElement("div");return e.className="ProseMirror-gapcursor",dt.create(t.doc,[pt.widget(t.selection.head,e,{key:"gapcursor"})])}const Zt=ie.create({name:"gapCursor",addProseMirrorPlugins(){return[Ut()]},extendNodeSchema(t){var e;const n={name:t.name,options:t.options,storage:t.storage};return{allowGapCursor:(e=ct(ft(t,"allowGapCursor",n)))!==null&&e!==void 0?e:null}}}),en=x.create({name:"hardBreak",addOptions(){return{keepMarks:!0,HTMLAttributes:{}}},inline:!0,group:"inline",selectable:!1,linebreakReplacement:!0,parseHTML(){return[{tag:"br"}]},renderHTML({HTMLAttributes:t}){return["br",S(this.options.HTMLAttributes,t)]},renderText(){return`
`},addCommands(){return{setHardBreak:()=>({commands:t,chain:e,state:n,editor:s})=>t.first([()=>t.exitCode(),()=>t.command(()=>{const{selection:r,storedMarks:i}=n;if(r.$from.parent.type.spec.isolating)return!1;const{keepMarks:o}=this.options,{splittableMarks:a}=s.extensionManager,p=i||r.$to.parentOffset&&r.$from.marks();return e().insertContent({type:this.name}).command(({tr:d,dispatch:h})=>{if(h&&p&&o){const u=p.filter(c=>a.includes(c.type.name));d.ensureMarks(u)}return!0}).run()})])}},addKeyboardShortcuts(){return{"Mod-Enter":()=>this.editor.commands.setHardBreak(),"Shift-Enter":()=>this.editor.commands.setHardBreak()}}}),Be=x.create({name:"heading",addOptions(){return{levels:[1,2,3,4,5,6],HTMLAttributes:{}}},content:"inline*",group:"block",defining:!0,addAttributes(){return{level:{default:1,rendered:!1}}},parseHTML(){return this.options.levels.map(t=>({tag:`h${t}`,attrs:{level:t}}))},renderHTML({node:t,HTMLAttributes:e}){return[`h${this.options.levels.includes(t.attrs.level)?t.attrs.level:this.options.levels[0]}`,S(this.options.HTMLAttributes,e),0]},addCommands(){return{setHeading:t=>({commands:e})=>this.options.levels.includes(t.level)?e.setNode(this.name,t):!1,toggleHeading:t=>({commands:e})=>this.options.levels.includes(t.level)?e.toggleNode(this.name,"paragraph",t):!1}},addKeyboardShortcuts(){return this.options.levels.reduce((t,e)=>({...t,[`Mod-Alt-${e}`]:()=>this.editor.commands.toggleHeading({level:e})}),{})},addInputRules(){return this.options.levels.map(t=>ge({find:new RegExp(`^(#{${Math.min(...this.options.levels)},${t}})\\s$`),type:this.type,getAttributes:{level:t}}))}});var ne=200,L=function(){};L.prototype.append=function(e){return e.length?(e=L.from(e),!this.length&&e||e.length<ne&&this.leafAppend(e)||this.length<ne&&e.leafPrepend(this)||this.appendInner(e)):this};L.prototype.prepend=function(e){return e.length?L.from(e).append(this):this};L.prototype.appendInner=function(e){return new tn(this,e)};L.prototype.slice=function(e,n){return e===void 0&&(e=0),n===void 0&&(n=this.length),e>=n?L.empty:this.sliceInner(Math.max(0,e),Math.min(this.length,n))};L.prototype.get=function(e){if(!(e<0||e>=this.length))return this.getInner(e)};L.prototype.forEach=function(e,n,s){n===void 0&&(n=0),s===void 0&&(s=this.length),n<=s?this.forEachInner(e,n,s,0):this.forEachInvertedInner(e,n,s,0)};L.prototype.map=function(e,n,s){n===void 0&&(n=0),s===void 0&&(s=this.length);var r=[];return this.forEach(function(i,o){return r.push(e(i,o))},n,s),r};L.from=function(e){return e instanceof L?e:e&&e.length?new Ne(e):L.empty};var Ne=function(t){function e(s){t.call(this),this.values=s}e.__proto__=t,e.prototype=Object.create(t.prototype),e.prototype.constructor=e;var n={length:{configurable:!0},depth:{configurable:!0}};return e.prototype.flatten=function(){return this.values},e.prototype.sliceInner=function(r,i){return r==0&&i==this.length?this:new e(this.values.slice(r,i))},e.prototype.getInner=function(r){return this.values[r]},e.prototype.forEachInner=function(r,i,o,a){for(var p=i;p<o;p++)if(r(this.values[p],a+p)===!1)return!1},e.prototype.forEachInvertedInner=function(r,i,o,a){for(var p=i-1;p>=o;p--)if(r(this.values[p],a+p)===!1)return!1},e.prototype.leafAppend=function(r){if(this.length+r.length<=ne)return new e(this.values.concat(r.flatten()))},e.prototype.leafPrepend=function(r){if(this.length+r.length<=ne)return new e(r.flatten().concat(this.values))},n.length.get=function(){return this.values.length},n.depth.get=function(){return 0},Object.defineProperties(e.prototype,n),e}(L);L.empty=new Ne([]);var tn=function(t){function e(n,s){t.call(this),this.left=n,this.right=s,this.length=n.length+s.length,this.depth=Math.max(n.depth,s.depth)+1}return e.__proto__=t,e.prototype=Object.create(t.prototype),e.prototype.constructor=e,e.prototype.flatten=function(){return this.left.flatten().concat(this.right.flatten())},e.prototype.getInner=function(s){return s<this.left.length?this.left.get(s):this.right.get(s-this.left.length)},e.prototype.forEachInner=function(s,r,i,o){var a=this.left.length;if(r<a&&this.left.forEachInner(s,r,Math.min(i,a),o)===!1||i>a&&this.right.forEachInner(s,Math.max(r-a,0),Math.min(this.length,i)-a,o+a)===!1)return!1},e.prototype.forEachInvertedInner=function(s,r,i,o){var a=this.left.length;if(r>a&&this.right.forEachInvertedInner(s,r-a,Math.max(i,a)-a,o+a)===!1||i<a&&this.left.forEachInvertedInner(s,Math.min(r,a),i,o)===!1)return!1},e.prototype.sliceInner=function(s,r){if(s==0&&r==this.length)return this;var i=this.left.length;return r<=i?this.left.slice(s,r):s>=i?this.right.slice(s-i,r-i):this.left.slice(s,i).append(this.right.slice(0,r-i))},e.prototype.leafAppend=function(s){var r=this.right.leafAppend(s);if(r)return new e(this.left,r)},e.prototype.leafPrepend=function(s){var r=this.left.leafPrepend(s);if(r)return new e(r,this.right)},e.prototype.appendInner=function(s){return this.left.depth>=Math.max(this.right.depth,s.depth)+1?new e(this.left,new e(this.right,s)):new e(this,s)},e}(L);const nn=500;class P{constructor(e,n){this.items=e,this.eventCount=n}popEvent(e,n){if(this.eventCount==0)return null;let s=this.items.length;for(;;s--)if(this.items.get(s-1).selection){--s;break}let r,i;n&&(r=this.remapping(s,this.items.length),i=r.maps.length);let o=e.tr,a,p,d=[],h=[];return this.items.forEach((u,c)=>{if(!u.step){r||(r=this.remapping(s,c+1),i=r.maps.length),i--,h.push(u);return}if(r){h.push(new E(u.map));let m=u.step.map(r.slice(i)),v;m&&o.maybeStep(m).doc&&(v=o.mapping.maps[o.mapping.maps.length-1],d.push(new E(v,void 0,void 0,d.length+h.length))),i--,v&&r.appendMap(v,i)}else o.maybeStep(u.step);if(u.selection)return a=r?u.selection.map(r.slice(i)):u.selection,p=new P(this.items.slice(0,s).append(h.reverse().concat(d)),this.eventCount-1),!1},this.items.length,0),{remaining:p,transform:o,selection:a}}addTransform(e,n,s,r){let i=[],o=this.eventCount,a=this.items,p=!r&&a.length?a.get(a.length-1):null;for(let h=0;h<e.steps.length;h++){let u=e.steps[h].invert(e.docs[h]),c=new E(e.mapping.maps[h],u,n),m;(m=p&&p.merge(c))&&(c=m,h?i.pop():a=a.slice(0,a.length-1)),i.push(c),n&&(o++,n=void 0),r||(p=c)}let d=o-s.depth;return d>rn&&(a=sn(a,d),o-=d),new P(a.append(i),o)}remapping(e,n){let s=new ht;return this.items.forEach((r,i)=>{let o=r.mirrorOffset!=null&&i-r.mirrorOffset>=e?s.maps.length-r.mirrorOffset:void 0;s.appendMap(r.map,o)},e,n),s}addMaps(e){return this.eventCount==0?this:new P(this.items.append(e.map(n=>new E(n))),this.eventCount)}rebased(e,n){if(!this.eventCount)return this;let s=[],r=Math.max(0,this.items.length-n),i=e.mapping,o=e.steps.length,a=this.eventCount;this.items.forEach(c=>{c.selection&&a--},r);let p=n;this.items.forEach(c=>{let m=i.getMirror(--p);if(m==null)return;o=Math.min(o,m);let v=i.maps[m];if(c.step){let _=e.steps[m].invert(e.docs[m]),O=c.selection&&c.selection.map(i.slice(p+1,m));O&&a++,s.push(new E(v,_,O))}else s.push(new E(v))},r);let d=[];for(let c=n;c<o;c++)d.push(new E(i.maps[c]));let h=this.items.slice(0,r).append(d).append(s),u=new P(h,a);return u.emptyItemCount()>nn&&(u=u.compress(this.items.length-s.length)),u}emptyItemCount(){let e=0;return this.items.forEach(n=>{n.step||e++}),e}compress(e=this.items.length){let n=this.remapping(0,e),s=n.maps.length,r=[],i=0;return this.items.forEach((o,a)=>{if(a>=e)r.push(o),o.selection&&i++;else if(o.step){let p=o.step.map(n.slice(s)),d=p&&p.getMap();if(s--,d&&n.appendMap(d,s),p){let h=o.selection&&o.selection.map(n.slice(s));h&&i++;let u=new E(d.invert(),p,h),c,m=r.length-1;(c=r.length&&r[m].merge(u))?r[m]=c:r.push(u)}}else o.map&&s--},this.items.length,0),new P(L.from(r.reverse()),i)}}P.empty=new P(L.empty,0);function sn(t,e){let n;return t.forEach((s,r)=>{if(s.selection&&e--==0)return n=r,!1}),t.slice(n)}class E{constructor(e,n,s,r){this.map=e,this.step=n,this.selection=s,this.mirrorOffset=r}merge(e){if(this.step&&e.step&&!e.selection){let n=e.step.merge(this.step);if(n)return new E(n.getMap().invert(),n,this.selection)}}}class ${constructor(e,n,s,r,i){this.done=e,this.undone=n,this.prevRanges=s,this.prevTime=r,this.prevComposition=i}}const rn=20;function on(t,e,n,s){let r=n.getMeta(V),i;if(r)return r.historyState;n.getMeta(un)&&(t=new $(t.done,t.undone,null,0,-1));let o=n.getMeta("appendedTransaction");if(n.steps.length==0)return t;if(o&&o.getMeta(V))return o.getMeta(V).redo?new $(t.done.addTransform(n,void 0,s,te(e)),t.undone,He(n.mapping.maps),t.prevTime,t.prevComposition):new $(t.done,t.undone.addTransform(n,void 0,s,te(e)),null,t.prevTime,t.prevComposition);if(n.getMeta("addToHistory")!==!1&&!(o&&o.getMeta("addToHistory")===!1)){let a=n.getMeta("composition"),p=t.prevTime==0||!o&&t.prevComposition!=a&&(t.prevTime<(n.time||0)-s.newGroupDelay||!an(n,t.prevRanges)),d=o?fe(t.prevRanges,n.mapping):He(n.mapping.maps);return new $(t.done.addTransform(n,p?e.selection.getBookmark():void 0,s,te(e)),P.empty,d,n.time,a??t.prevComposition)}else return(i=n.getMeta("rebased"))?new $(t.done.rebased(n,i),t.undone.rebased(n,i),fe(t.prevRanges,n.mapping),t.prevTime,t.prevComposition):new $(t.done.addMaps(n.mapping.maps),t.undone.addMaps(n.mapping.maps),fe(t.prevRanges,n.mapping),t.prevTime,t.prevComposition)}function an(t,e){if(!e)return!1;if(!t.docChanged)return!0;let n=!1;return t.mapping.maps[0].forEach((s,r)=>{for(let i=0;i<e.length;i+=2)s<=e[i+1]&&r>=e[i]&&(n=!0)}),n}function He(t){let e=[];for(let n=t.length-1;n>=0&&e.length==0;n--)t[n].forEach((s,r,i,o)=>e.push(i,o));return e}function fe(t,e){if(!t)return null;let n=[];for(let s=0;s<t.length;s+=2){let r=e.map(t[s],1),i=e.map(t[s+1],-1);r<=i&&n.push(r,i)}return n}function ln(t,e,n){let s=te(e),r=V.get(e).spec.config,i=(n?t.undone:t.done).popEvent(e,s);if(!i)return null;let o=i.selection.resolve(i.transform.doc),a=(n?t.done:t.undone).addTransform(i.transform,e.selection.getBookmark(),r,s),p=new $(n?a:i.remaining,n?i.remaining:a,null,0,-1);return i.transform.setSelection(o).setMeta(V,{redo:n,historyState:p})}let he=!1,Ie=null;function te(t){let e=t.plugins;if(Ie!=e){he=!1,Ie=e;for(let n=0;n<e.length;n++)if(e[n].spec.historyPreserveItems){he=!0;break}}return he}const V=new ye("history"),un=new ye("closeHistory");function dn(t={}){return t={depth:t.depth||100,newGroupDelay:t.newGroupDelay||500},new re({key:V,state:{init(){return new $(P.empty,P.empty,null,0,-1)},apply(e,n,s){return on(n,s,e,t)}},config:t,props:{handleDOMEvents:{beforeinput(e,n){let s=n.inputType,r=s=="historyUndo"?ze:s=="historyRedo"?Fe:null;return r?(n.preventDefault(),r(e.state,e.dispatch)):!1}}}})}function Ve(t,e){return(n,s)=>{let r=V.getState(n);if(!r||(t?r.undone:r.done).eventCount==0)return!1;if(s){let i=ln(r,n,t);i&&s(e?i.scrollIntoView():i)}return!0}}const ze=Ve(!1,!0),Fe=Ve(!0,!0),pn=ie.create({name:"history",addOptions(){return{depth:100,newGroupDelay:500}},addCommands(){return{undo:()=>({state:t,dispatch:e})=>ze(t,e),redo:()=>({state:t,dispatch:e})=>Fe(t,e)}},addProseMirrorPlugins(){return[dn(this.options)]},addKeyboardShortcuts(){return{"Mod-z":()=>this.editor.commands.undo(),"Shift-Mod-z":()=>this.editor.commands.redo(),"Mod-y":()=>this.editor.commands.redo(),"Mod-я":()=>this.editor.commands.undo(),"Shift-Mod-я":()=>this.editor.commands.redo()}}}),cn=x.create({name:"horizontalRule",addOptions(){return{HTMLAttributes:{}}},group:"block",parseHTML(){return[{tag:"hr"}]},renderHTML({HTMLAttributes:t}){return["hr",S(this.options.HTMLAttributes,t)]},addCommands(){return{setHorizontalRule:()=>({chain:t,state:e})=>{const{selection:n}=e,{$from:s,$to:r}=n,i=t();return s.parentOffset===0?i.insertContentAt({from:Math.max(s.pos-1,0),to:r.pos},{type:this.name}):mt(n)?i.insertContentAt(r.pos,{type:this.name}):i.insertContent({type:this.name}),i.command(({tr:o,dispatch:a})=>{var p;if(a){const{$to:d}=o.selection,h=d.end();if(d.nodeAfter)d.nodeAfter.isTextblock?o.setSelection(D.create(o.doc,d.pos+1)):d.nodeAfter.isBlock?o.setSelection(be.create(o.doc,d.pos)):o.setSelection(D.create(o.doc,d.pos));else{const u=(p=d.parent.type.contentMatch.defaultType)===null||p===void 0?void 0:p.create();u&&(o.insert(h,u),o.setSelection(D.create(o.doc,h+1)))}o.scrollIntoView()}return!0}).run()}}},addInputRules(){return[$e({find:/^(?:---|—-|___\s|\*\*\*\s)$/,type:this.type})]}}),fn=/(?:^|\s)(\*(?!\s+\*)((?:[^*]+))\*(?!\s+\*))$/,hn=/(?:^|\s)(\*(?!\s+\*)((?:[^*]+))\*(?!\s+\*))/g,mn=/(?:^|\s)(_(?!\s+_)((?:[^_]+))_(?!\s+_))$/,gn=/(?:^|\s)(_(?!\s+_)((?:[^_]+))_(?!\s+_))/g,vn=se.create({name:"italic",addOptions(){return{HTMLAttributes:{}}},parseHTML(){return[{tag:"em"},{tag:"i",getAttrs:t=>t.style.fontStyle!=="normal"&&null},{style:"font-style=normal",clearMark:t=>t.type.name===this.name},{style:"font-style=italic"}]},renderHTML({HTMLAttributes:t}){return["em",S(this.options.HTMLAttributes,t),0]},addCommands(){return{setItalic:()=>({commands:t})=>t.setMark(this.name),toggleItalic:()=>({commands:t})=>t.toggleMark(this.name),unsetItalic:()=>({commands:t})=>t.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-i":()=>this.editor.commands.toggleItalic(),"Mod-I":()=>this.editor.commands.toggleItalic()}},addInputRules(){return[K({find:fn,type:this.type}),K({find:mn,type:this.type})]},addPasteRules(){return[W({find:hn,type:this.type}),W({find:gn,type:this.type})]}}),yn=x.create({name:"listItem",addOptions(){return{HTMLAttributes:{},bulletListTypeName:"bulletList",orderedListTypeName:"orderedList"}},content:"paragraph block*",defining:!0,parseHTML(){return[{tag:"li"}]},renderHTML({HTMLAttributes:t}){return["li",S(this.options.HTMLAttributes,t),0]},addKeyboardShortcuts(){return{Enter:()=>this.editor.commands.splitListItem(this.name),Tab:()=>this.editor.commands.sinkListItem(this.name),"Shift-Tab":()=>this.editor.commands.liftListItem(this.name)}}}),bn="listItem",_e="textStyle",Pe=/^(\d+)\.\s$/,kn=x.create({name:"orderedList",addOptions(){return{itemTypeName:"listItem",HTMLAttributes:{},keepMarks:!1,keepAttributes:!1}},group:"block list",content(){return`${this.options.itemTypeName}+`},addAttributes(){return{start:{default:1,parseHTML:t=>t.hasAttribute("start")?parseInt(t.getAttribute("start")||"",10):1},type:{default:void 0,parseHTML:t=>t.getAttribute("type")}}},parseHTML(){return[{tag:"ol"}]},renderHTML({HTMLAttributes:t}){const{start:e,...n}=t;return e===1?["ol",S(this.options.HTMLAttributes,n),0]:["ol",S(this.options.HTMLAttributes,t),0]},addCommands(){return{toggleOrderedList:()=>({commands:t,chain:e})=>this.options.keepAttributes?e().toggleList(this.name,this.options.itemTypeName,this.options.keepMarks).updateAttributes(bn,this.editor.getAttributes(_e)).run():t.toggleList(this.name,this.options.itemTypeName,this.options.keepMarks)}},addKeyboardShortcuts(){return{"Mod-Shift-7":()=>this.editor.commands.toggleOrderedList()}},addInputRules(){let t=U({find:Pe,type:this.type,getAttributes:e=>({start:+e[1]}),joinPredicate:(e,n)=>n.childCount+n.attrs.start===+e[1]});return(this.options.keepMarks||this.options.keepAttributes)&&(t=U({find:Pe,type:this.type,keepMarks:this.options.keepMarks,keepAttributes:this.options.keepAttributes,getAttributes:e=>({start:+e[1],...this.editor.getAttributes(_e)}),joinPredicate:(e,n)=>n.childCount+n.attrs.start===+e[1],editor:this.editor})),[t]}}),Ke=x.create({name:"paragraph",priority:1e3,addOptions(){return{HTMLAttributes:{}}},group:"block",content:"inline*",parseHTML(){return[{tag:"p"}]},renderHTML({HTMLAttributes:t}){return["p",S(this.options.HTMLAttributes,t),0]},addCommands(){return{setParagraph:()=>({commands:t})=>t.setNode(this.name)}},addKeyboardShortcuts(){return{"Mod-Alt-0":()=>this.editor.commands.setParagraph()}}}),Mn=/(?:^|\s)(~~(?!\s+~~)((?:[^~]+))~~(?!\s+~~))$/,Cn=/(?:^|\s)(~~(?!\s+~~)((?:[^~]+))~~(?!\s+~~))/g,wn=se.create({name:"strike",addOptions(){return{HTMLAttributes:{}}},parseHTML(){return[{tag:"s"},{tag:"del"},{tag:"strike"},{style:"text-decoration",consuming:!1,getAttrs:t=>t.includes("line-through")?{}:!1}]},renderHTML({HTMLAttributes:t}){return["s",S(this.options.HTMLAttributes,t),0]},addCommands(){return{setStrike:()=>({commands:t})=>t.setMark(this.name),toggleStrike:()=>({commands:t})=>t.toggleMark(this.name),unsetStrike:()=>({commands:t})=>t.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-Shift-s":()=>this.editor.commands.toggleStrike()}},addInputRules(){return[K({find:Mn,type:this.type})]},addPasteRules(){return[W({find:Cn,type:this.type})]}}),We=x.create({name:"text",group:"inline"}),Tn=ie.create({name:"starterKit",addExtensions(){var t,e,n,s,r,i,o,a,p,d,h,u,c,m,v,_,O,B;const y=[];return this.options.bold!==!1&&y.push(Ot.configure((t=this.options)===null||t===void 0?void 0:t.bold)),this.options.blockquote!==!1&&y.push(Ht.configure((e=this.options)===null||e===void 0?void 0:e.blockquote)),this.options.bulletList!==!1&&y.push($t.configure((n=this.options)===null||n===void 0?void 0:n.bulletList)),this.options.code!==!1&&y.push(Nt.configure((s=this.options)===null||s===void 0?void 0:s.code)),this.options.codeBlock!==!1&&y.push(Ft.configure((r=this.options)===null||r===void 0?void 0:r.codeBlock)),this.options.document!==!1&&y.push(De.configure((i=this.options)===null||i===void 0?void 0:i.document)),this.options.dropcursor!==!1&&y.push(Gt.configure((o=this.options)===null||o===void 0?void 0:o.dropcursor)),this.options.gapcursor!==!1&&y.push(Zt.configure((a=this.options)===null||a===void 0?void 0:a.gapcursor)),this.options.hardBreak!==!1&&y.push(en.configure((p=this.options)===null||p===void 0?void 0:p.hardBreak)),this.options.heading!==!1&&y.push(Be.configure((d=this.options)===null||d===void 0?void 0:d.heading)),this.options.history!==!1&&y.push(pn.configure((h=this.options)===null||h===void 0?void 0:h.history)),this.options.horizontalRule!==!1&&y.push(cn.configure((u=this.options)===null||u===void 0?void 0:u.horizontalRule)),this.options.italic!==!1&&y.push(vn.configure((c=this.options)===null||c===void 0?void 0:c.italic)),this.options.listItem!==!1&&y.push(yn.configure((m=this.options)===null||m===void 0?void 0:m.listItem)),this.options.orderedList!==!1&&y.push(kn.configure((v=this.options)===null||v===void 0?void 0:v.orderedList)),this.options.paragraph!==!1&&y.push(Ke.configure((_=this.options)===null||_===void 0?void 0:_.paragraph)),this.options.strike!==!1&&y.push(wn.configure((O=this.options)===null||O===void 0?void 0:O.strike)),this.options.text!==!1&&y.push(We.configure((B=this.options)===null||B===void 0?void 0:B.text)),y}}),An=/(?:^|\s)(!\[(.+|:?)]\((\S+)(?:(?:\s+)["'](\S+)["'])?\))$/,Ln=x.create({name:"image",addOptions(){return{inline:!1,allowBase64:!1,HTMLAttributes:{}}},inline(){return this.options.inline},group(){return this.options.inline?"inline":"block"},draggable:!0,addAttributes(){return{src:{default:null},alt:{default:null},title:{default:null}}},parseHTML(){return[{tag:this.options.allowBase64?"img[src]":'img[src]:not([src^="data:"])'}]},renderHTML({HTMLAttributes:t}){return["img",S(this.options.HTMLAttributes,t)]},addCommands(){return{setImage:t=>({commands:e})=>e.insertContent({type:this.name,attrs:t})}},addInputRules(){return[$e({find:An,type:this.type,getAttributes:t=>{const[,,e,n,s]=t;return{src:n,alt:e,title:s}}})]}}),xn=x.create({name:"colorWheel",group:"block",atom:!0,addAttributes(){return{sportColor:{default:"#FF6B6B"},cruiserColor:{default:"#4ECDC4"},urbanColor:{default:"#FFD93D"},offroadColor:{default:"#95E1D3"}}},parseHTML(){return[{tag:'div[data-type="color-wheel"]'}]},renderHTML({HTMLAttributes:t}){return["div",{"data-type":"color-wheel",...t},0]},addNodeView(){return gt(bt)}}),Sn=At(xt),Hn={class:"editor-wrapper"},In={key:0,class:"login-prompt"},_n={key:1,class:"editor-layout"},Pn={class:"editor-main"},En={class:"editor-toolbar"},On={class:"toolbar-left"},Rn={class:"file-path"},$n={class:"toolbar-right"},Dn={key:3,class:"toolbar-button loading",disabled:""},Bn={class:"editor-content"},Nn={key:0,class:"tiptap-toolbar"},Vn={key:1,class:"raw-content-wrapper"},zn={key:2,class:"preview-wrapper"},Fn=["innerHTML"],Yn=ve({__name:"TiptapEditor",props:{content:{},filePath:{}},emits:["update:content","save","error"],setup(t,{emit:e}){const n=l=>{if(c.value)switch(l){case"colorwheel":c.value.chain().focus().insertContent({type:"colorWheel"}).run();break}},s={"split-with-image":`
    <div style="display: flex; gap: 2rem; margin: 3rem 0;">
      <div style="flex: 1;">
        <h2 style="margin: 0; font-size: 1.5rem; font-weight: 600; line-height: 1.4;">Section Title</h2>
      </div>
      <div style="flex: 2;">
        <div style="background: #f5f5f5; padding: 2rem; border-radius: 4px;">
          <img src="/api/placeholder/800/400" alt="Section Image" style="width: 100%; height: auto; display: block;" />
        </div>
        <h3 style="font-size: 1.25rem; font-weight: 600; margin: 1rem 0;">Add Subtitle</h3>
        <p style="margin: 1rem 0; line-height: 1.6;">Add your description here.</p>
        <p style="margin: 1rem 0; line-height: 1.6;">Add additional details here.</p>
      </div>
    </div>
  `,"split-with-list":`
    <div style="display: flex; gap: 2rem; margin: 3rem 0;">
      <div style="flex: 1;">
        <h2 style="margin: 0; font-size: 1.5rem; font-weight: 600; line-height: 1.4;">Section Title</h2>
      </div>
      <div style="flex: 2;">
        <img src="/api/placeholder/800/400" alt="Section Image" style="width: 100%; height: auto; display: block; padding: 2rem; border-radius: 4px;" />
        <p style="margin: 1rem 0; line-height: 1.6;">Add your description here.</p>
        <ul style="list-style: none; padding: 0; margin: 1rem 0;">
          <li style="margin: 0.5rem 0; line-height: 1.6;">List item one</li>
          <li style="margin: 0.5rem 0; line-height: 1.6;">List item two</li>
          <li style="margin: 0.5rem 0; line-height: 1.6;">List item three</li>
          <li style="margin: 0.5rem 0; line-height: 1.6;">List item four</li>
        </ul>
      </div>
    </div>
  `},r=l=>{if(!c.value)return;const f=s[l];f&&c.value.chain().focus().createParagraphNear().insertContent(f).focus().run()},i=t,o=e,a=I(""),p=I(""),d=I(!1),h=I(!1),u=I(!1),c=I(null),m=I(!1),v=I(""),_=I(null),{showToast:O}=at(),B=Ct(),{isLoggedIn:y}=B,Me=kt(),Ge=x.create({name:"styledDiv",group:"block",content:"block+",addAttributes(){return{style:{default:null,parseHTML:l=>l.getAttribute("style"),renderHTML:l=>l.style?{style:l.style}:{}},class:{default:null,parseHTML:l=>l.getAttribute("class"),renderHTML:l=>l.class?{class:l.class}:{}}}},parseHTML(){return[{tag:"div"}]},renderHTML({HTMLAttributes:l}){return["div",l,0]}}),qe=x.create({name:"gridContainer",group:"block",content:"block+",addAttributes(){return{style:{default:null,parseHTML:l=>l.getAttribute("style"),renderHTML:l=>l.style?{style:l.style}:{}}}},parseHTML(){return[{tag:"div",getAttrs:l=>(l.getAttribute("style")||"").includes("grid")?{}:!1}]},renderHTML({HTMLAttributes:l}){return["div",l,0]}}),oe=()=>{!R.value||d.value||(Me.saveContent(i.filePath,a.value),O({title:"Success",message:"Content saved locally",type:"success"}))},Ce=l=>l?l.replace(/::color-wheel\s*::/g,'<div data-type="color-wheel"></div>').replace(/::test-component\s*::/g,'<div data-type="test-component"></div>'):"",je={theme:"vs",language:"html",fontSize:13,lineNumbers:"on",renderWhitespace:"selection",minimap:{enabled:!0,scale:1,showSlider:"mouseover"},scrollBeyondLastLine:!1,wordWrap:"on",lineHeight:20,padding:{top:16,bottom:16},folding:!0,foldingHighlight:!0,foldingStrategy:"indentation",showFoldingControls:"always",bracketPairColorization:{enabled:!0},autoClosingBrackets:"always",autoClosingQuotes:"always",autoClosingTags:!0,formatOnType:!0,formatOnPaste:!0,autoIndent:"advanced",tabSize:2,automaticLayout:!0,scrollbar:{vertical:"visible",horizontal:"visible",useShadows:!1,verticalHasArrows:!1,horizontalHasArrows:!1,verticalScrollbarSize:10,horizontalScrollbarSize:10},suggest:{snippetsPreventQuickSuggestions:!1,showWords:!1,showClasses:!0,showTags:!0,showAttributes:!0},quickSuggestions:{other:!0,comments:!1,strings:!0}},Ue=l=>{l&&(a.value=l,v.value=l,o("update:content",l))};N(u,l=>{c.value&&(l?ot(()=>{_.value&&_.value.setValue(a.value)}):(c.value.commands.setContent(a.value,!1),v.value=a.value))}),N(()=>i.content,l=>{if(!c.value||l===void 0)return;const f=Ce(l);f!==a.value&&(c.value.commands.setContent(f,!1),a.value=f,v.value=f)},{deep:!0}),j(()=>{if(Me.loadSaves(),c.value=new vt({extensions:[Tn.configure({document:!1,paragraph:!1,heading:!1,bulletList:!1,orderedList:!1}),De,We,Ke.configure({HTMLAttributes:{class:null}}),Be.configure({HTMLAttributes:{class:null}}),Ln.configure({inline:!0,HTMLAttributes:{class:null}}),Ge,qe,xn.configure({HTMLAttributes:{class:"color-wheel-node"}})],editorProps:{attributes:{spellcheck:"false"},transformPastedHTML:l=>l,handleDrop:!1,handleClick:(l,f,k)=>{const g=l.posAtCoords({left:k.clientX,top:k.clientY});if(!g)return!1;const{pos:M}=g;if(l.state.doc.resolve(M),!l.domAtPos(M))return!1;const A=k.target;return A.nodeName==="IMG"||A.closest("img")?!1:(l.dispatch(l.state.tr.setSelection(D.create(l.state.doc,M))),l.focus(),!0)},handleKeyDown:(l,f)=>{var k,g;if(f.key==="Enter"){const{state:M}=l,{selection:G}=M,{$from:A}=G,q=A.parent;let X=A.depth,le=null;for(;X>0;){const z=A.node(X);if(z.type.name==="styledDiv"&&((k=z.attrs.style)!=null&&k.includes("display: flex"))){le=z;break}X--}if(!le)return!1;const Xe=(g=q.attrs.style)==null?void 0:g.includes("flex: 1");if(A.pos===M.doc.content.size&&f.shiftKey)return l.dispatch(M.tr.insert(A.pos,M.schema.nodes.styledDiv.create({style:"display: flex; gap: 2rem; margin: 3rem 0;"},[M.schema.nodes.styledDiv.create({style:"flex: 1;"},[M.schema.nodes.paragraph.create()]),M.schema.nodes.styledDiv.create({style:"flex: 2;"},[M.schema.nodes.paragraph.create()])]))),!0;if(Xe){if(f.shiftKey)return l.dispatch(M.tr.insert(A.pos,M.schema.nodes.hardBreak.create())),!0;const z=le.lastChild;if(z){const we=l.nodeDOM(z.pos);if(we){const Ye=l.posAtDOM(we,0);return l.dispatch(M.tr.setSelection(D.create(M.doc,Ye))),!0}}}else return!1}return f.key==="Tab"}},onUpdate:({editor:l})=>{var M,G;const{selection:f}=l.state,{$from:k}=f,g=k.parent;if(g.type.name==="styledDiv"&&((M=g.attrs.style)!=null&&M.includes("display: flex"))){k.node(),k.before(k.depth);let A=k.depth;for(;A>1;){if((G=k.node(A).attrs.style)!=null&&G.includes("display: flex")){k.before(A);break}A--}const q=l.getHTML();a.value=q,v.value=q,o("update:content",q)}else{const A=l.getHTML();a.value=A,v.value=A,o("update:content",A)}},parseOptions:{preserveWhitespace:"full"}}),i.content){const l=Ce(i.content);c.value.commands.setContent(l,!1),a.value=l,p.value=l,v.value=l}m.value=!0}),j(()=>{const l=document.querySelector(".editor-content");l&&l.addEventListener("scroll",()=>{l.setAttribute("data-scroll-top",l.scrollTop.toString())})}),me(()=>{const l=document.querySelector(".editor-content");l&&l.removeEventListener("scroll",()=>{})}),N(u,l=>{c.value&&(l||(c.value.commands.setContent(a.value,!1),v.value=a.value))});const R=Oe(()=>a.value!==p.value),ae=async()=>{var l;if(!(!R.value||d.value)){d.value=!0;try{if(!y.value)throw new Error("Please log in to GitHub first");{const k=(l=Ee().$content)==null?void 0:l.storage;k&&await k.clearAll()}o("save",a.value),p.value=a.value}catch(f){console.error("Save error:",f),O({title:"Error",message:f instanceof Error?f.message:"Failed to save changes",type:"error"}),o("error",f)}finally{d.value=!1}}},Je=l=>{c.value&&(c.value.commands.setContent(l),a.value=l)};return me(()=>{c.value&&c.value.destroy(),_.value&&_.value.dispose()}),(l,f)=>{const k=Sn;return w(),T("div",Hn,[Y(y)?(w(),T("div",_n,[C("div",Pn,[C("div",En,[C("div",On,[C("span",Rn,rt(i.filePath),1)]),C("div",$n,[!h.value&&!u.value?(w(),T(Q,{key:0},[C("button",{class:"toolbar-button",onClick:f[1]||(f[1]=g=>u.value=!0)}," Raw "),C("button",{class:"toolbar-button",onClick:f[2]||(f[2]=g=>h.value=!0)}," Preview "),R.value&&!d.value?(w(),T("button",{key:0,class:"toolbar-button primary",onClick:ae}," Commit Changes ")):H("",!0),R.value&&!d.value?(w(),T("button",{key:1,class:"toolbar-button primary",onClick:oe}," Save Locally ")):H("",!0)],64)):H("",!0),u.value?(w(),T(Q,{key:1},[C("button",{class:"toolbar-button",onClick:f[3]||(f[3]=g=>u.value=!1)}," Normal "),C("button",{class:"toolbar-button",onClick:f[4]||(f[4]=g=>{h.value=!0,u.value=!1})}," Preview "),R.value&&!d.value?(w(),T("button",{key:0,class:"toolbar-button primary",onClick:ae}," Commit Changes ")):H("",!0),R.value&&!d.value?(w(),T("button",{key:1,class:"toolbar-button primary",onClick:oe}," Save Locally ")):H("",!0)],64)):H("",!0),h.value?(w(),T(Q,{key:2},[C("button",{class:"toolbar-button",onClick:f[5]||(f[5]=g=>h.value=!1)}," Edit "),R.value&&!d.value?(w(),T("button",{key:0,class:"toolbar-button primary",onClick:ae}," Commit Changes ")):H("",!0),R.value&&!d.value?(w(),T("button",{key:1,class:"toolbar-button primary",onClick:oe}," Save Locally ")):H("",!0)],64)):H("",!0),d.value?(w(),T("button",Dn," Saving... ")):H("",!0)])]),C("div",Bn,[!h.value&&!u.value?(w(),T(Q,{key:0},[c.value?(w(),T("div",Nn,[C("button",{onClick:f[6]||(f[6]=g=>c.value.chain().focus().toggleBold().run()),class:F({"is-active":c.value.isActive("bold")})}," Bold ",2),C("button",{onClick:f[7]||(f[7]=g=>c.value.chain().focus().toggleItalic().run()),class:F({"is-active":c.value.isActive("italic")})}," Italic ",2),C("button",{onClick:f[8]||(f[8]=g=>c.value.chain().focus().toggleHeading({level:1}).run()),class:F({"is-active":c.value.isActive("heading",{level:1})})}," H1 ",2),C("button",{onClick:f[9]||(f[9]=g=>c.value.chain().focus().toggleHeading({level:2}).run()),class:F({"is-active":c.value.isActive("heading",{level:2})})}," H2 ",2),C("button",{onClick:f[10]||(f[10]=g=>c.value.chain().focus().toggleBulletList().run()),class:F({"is-active":c.value.isActive("bulletList")})}," List ",2),pe(wt,{onInsertComponent:n,onInsertSection:r})])):H("",!0),m.value?(w(),it(Y(yt),{key:1,editor:c.value,class:F(["content-wrapper",{"has-changes":R.value}])},null,8,["editor","class"])):H("",!0)],64)):u.value?(w(),T("div",Vn,[pe(k,{modelValue:a.value,"onUpdate:modelValue":f[11]||(f[11]=g=>a.value=g),class:"monaco-editor",options:je,onChange:Ue,onMount:f[12]||(f[12]=g=>_.value=g)},null,8,["modelValue"])])):(w(),T("div",zn,[C("div",{class:"content-wrapper",innerHTML:v.value},null,8,Fn)]))])]),pe(Mt,{filePath:i.filePath,onLoadSave:Je},null,8,["filePath"])])):(w(),T("div",In,[f[13]||(f[13]=C("p",{class:"login-message"},"Please sign in with GitHub to edit this file",-1)),C("button",{onClick:f[0]||(f[0]=(...g)=>Y(B).login&&Y(B).login(...g)),class:"login-button"}," Sign in with GitHub ")]))])}}});export{Yn as _,Xn as a};
